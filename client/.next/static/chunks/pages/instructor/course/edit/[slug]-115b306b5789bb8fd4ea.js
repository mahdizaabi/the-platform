(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[932],{8744:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return G}});var r=n(5893),a=n(6156),o=n(2921),i=n(7757),c=n.n(i),s=n(2137),l=n(9669),d=n.n(l),u=n(1163),p=n(7294),f=(n(2448),n(9981),n(9778)),v=n(7385),h=n(8453),m=n(7888),g=n(7215),x={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},b=n(76),j=function(e,t){return p.createElement(b.Z,Object.assign({},e,{ref:t,icon:x}))};j.displayName="DeleteOutlined";var w=p.forwardRef(j),y=n(8749),O=n(2122),C=n(8481),N=n(1253),k=n(4184),Z=n.n(k),_=n(1770),P=n(5105),S=p.forwardRef((function(e,t){var n,r=e.prefixCls,o=void 0===r?"rc-switch":r,i=e.className,c=e.checked,s=e.defaultChecked,l=e.disabled,d=e.loadingIcon,u=e.checkedChildren,f=e.unCheckedChildren,v=e.onClick,h=e.onChange,m=e.onKeyDown,g=(0,N.Z)(e,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),x=(0,_.Z)(!1,{value:c,defaultValue:s}),b=(0,C.Z)(x,2),j=b[0],w=b[1];function y(e,t){var n=j;return l||(w(n=e),null===h||void 0===h||h(n,t)),n}var O=Z()(o,i,(n={},(0,a.Z)(n,"".concat(o,"-checked"),j),(0,a.Z)(n,"".concat(o,"-disabled"),l),n));return p.createElement("button",Object.assign({},g,{type:"button",role:"switch","aria-checked":j,disabled:l,className:O,ref:t,onKeyDown:function(e){e.which===P.Z.LEFT?y(!1,e):e.which===P.Z.RIGHT&&y(!0,e),null===m||void 0===m||m(e)},onClick:function(e){var t=y(!j,e);null===v||void 0===v||v(t,e)}}),d,p.createElement("span",{className:"".concat(o,"-inner")},j?u:f))}));S.displayName="Switch";var E=S,D=n(7085),I=n(1790),U=n(6032),T=n(7647),L=n(1687),z=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},H=p.forwardRef((function(e,t){var n,r=e.prefixCls,o=e.size,i=e.loading,c=e.className,s=void 0===c?"":c,l=e.disabled,d=z(e,["prefixCls","size","loading","className","disabled"]);(0,L.Z)("checked"in d||!("value"in d),"Switch","`value` is not a valid prop, do you mean `checked`?");var u=p.useContext(U.E_),f=u.getPrefixCls,v=u.direction,h=p.useContext(T.Z),m=f("switch",r),g=p.createElement("div",{className:"".concat(m,"-handle")},i&&p.createElement(D.Z,{className:"".concat(m,"-loading-icon")})),x=Z()((n={},(0,a.Z)(n,"".concat(m,"-small"),"small"===(o||h)),(0,a.Z)(n,"".concat(m,"-loading"),i),(0,a.Z)(n,"".concat(m,"-rtl"),"rtl"===v),n),s);return p.createElement(I.Z,{insertExtraNode:!0},p.createElement(E,(0,O.Z)({},d,{prefixCls:m,className:x,disabled:l||i,ref:t,loadingIcon:g})))}));H.__ANT_SWITCH=!0,H.displayName="Switch";var V=H,R=n(1577),F=n(2004);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t=e.currentItem,n=e.setCurrentItem,a=e.handleUpdateLesson,o=e.uploading,i=e.uploadVideoButtonText,c=e.handleVideo,s=e.progress;return(0,r.jsx)("div",{className:"container addLesson-formContainer pt-3",children:(0,r.jsxs)("form",{action:"",encType:"multipart/form-data",onSubmit:a,children:[(0,r.jsx)("input",{type:"text",name:"lesson-title-input",className:"form-control square",id:"lesson-title-input",autoFocus:!0,required:!0,onChange:function(e){return n(q(q({},t),{},{title:e.target.value}))},value:null===t||void 0===t?void 0:t.title}),(0,r.jsx)("textarea",{name:"",className:"form-control mt-3",cols:"7",rows:"7",onChange:function(e){return n(q(q({},t),{},{content:e.target.value}))},value:t.content}),(0,r.jsxs)("div",{className:"video_input col d-flex align-items-center",children:[(0,r.jsxs)("label",{htmlFor:"video",className:"btn col-4 btn-dark btn-block text-left mt-3",children:[i||"upload video",(0,r.jsx)("input",{type:"file",accept:"video/*",name:"video",hidden:!0,onChange:function(e){return c(e)},id:"video"})]}),o&&(0,r.jsx)("div",{className:"mt-3 col-3",children:(0,r.jsx)(y.Z,{style:{marginLeft:"12px"},type:"circle",percent:s,width:40})})]}),!o&&t.video&&t.video.videoUrl&&(0,r.jsx)("div",{className:"mt-3 bg-warning d-flex align-items-center justify-content-center",children:(0,r.jsx)("div",{className:"pt-2 d-flex bg-danger justify-content-center",children:(0,r.jsx)(F.Z,{url:t.video.videoUrl,width:"410px",height:"240px",controls:!0})})}),(0,r.jsxs)("div",{className:"d-flex justify-content-between pt2",children:[(0,r.jsx)("span",{className:"pt-3 text-danger badge",children:t.free_preview?"video preview is enabled":"video preview is diabled"}),(0,r.jsx)(V,{className:"float-right mt-2",disabled:o,defaultChecked:t.free_preview,name:"free_preview",onChange:function(e){return n(q(q({},t),{},{free_preview:e}))}})]}),(0,r.jsx)(R.Z,{onClick:a,className:"col mt-3",size:"large",type:"primary",loading:o,shape:"round",disabled:null===t||void 0===t||!t.content||null===t||void 0===t||!t.title,children:o&&t.video.videoUrl?"uploading Lesson ...":o&&!t.video.videoUrl?"uploading video":"add lesson"})]})})},B=n(9249);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(){var e=(0,u.useRouter)().query.slug,t=(0,p.useState)([]),n=t[0],a=t[1],i=(0,p.useState)(!1),l=i[0],x=i[1],b=(0,p.useState)({}),j=b[0],y=b[1],O=(0,p.useState)("upload video"),C=O[0],N=O[1],k=(0,p.useState)(0),Z=k[0],_=(k[1],(0,p.useState)(!1)),P=_[0],S=_[1],E=(0,p.useState)(0),D=(E[0],E[1]),I=(0,p.useState)({}),U=(I[0],I[1]);(0,p.useEffect)((function(){(function(){var t=(0,s.Z)(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d().get("/api/course/".concat(e));case 2:(n=t.sent).data&&a(n.data.lessons);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[e]);var T=function(){var t=(0,s.Z)(c().mark((function t(r,o){var i,s;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.prompt("Are you sure you want to delte")){t.next=3;break}return t.abrupt("return");case 3:return i=n.filter((function(e,t){return r!==t})),a(i),s=o._id,t.next=8,d().delete("/api/course/lesson/delete/".concat(e,"/").concat(s));case 8:t.sent;case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),L=function(){var t=(0,s.Z)(c().mark((function t(n){var r,a,o,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!j.video||!j.video.videoUrl){t.next=17;break}return r=j.video.videoUrl.split("/evideos/")[1].split(".mp4")[0],console.log(r),t.prev=3,S(!0),t.next=7,d().get("/api/course/video/remove/".concat(e,"/").concat(r));case 7:t.sent,y(X(X({},j),{},{video:{videoUrl:""}})),S(!1),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(3),console.log(t.t0),S(!1),(0,B.Am)("video removing failed :( ");case 17:return a=n.target.files[0],N(a.name),S(!0),(o=new FormData).append("video",a),t.next=24,d().post("/api/course/video/upload",o,{onUploadProgress:function(e){D(Math.round(100*e.loaded)/e.total)}});case 24:i=t.sent,y(X(X({},j),{},{video:i.data})),S(!1);case 27:case"end":return t.stop()}}),t,null,[[3,12]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=(0,s.Z)(c().mark((function t(r){var i,s,l;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.prev=1,t.next=4,d().put("/api/course/lesson/update/".concat(e,"/").concat(j._id),j);case 4:i=t.sent,s=i.data,y(s),N("Upload Video"),x("Lesson Updated"),U(s),s.ok&&(l=n.findIndex((function(e){return e._id===j._id})),n[l]=j,a((0,o.Z)(n)),console.log(n)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})));return function(e){return t.apply(this,arguments)}}();return(0,r.jsxs)("div",{className:"container edit_page",children:[(0,r.jsx)(f.default,{submitUrl:"/api/course/edit/".concat(e)}),(0,r.jsx)("div",{className:"row d-flex justify-content-center",children:(0,r.jsxs)("div",{className:"col-8 p-3",children:[(0,r.jsx)("hr",{}),(0,r.jsx)("div",{className:"lesson-list",children:(0,r.jsxs)("h4",{children:[null===n||void 0===n?void 0:n.length," lessons"]})}),(0,r.jsx)("hr",{}),(0,r.jsx)(v.ZP,{onDragOver:function(e){return e.preventDefault()},itemLayout:"horizental",dataSource:n,renderItem:function(e,t){return(0,r.jsxs)(g.default,{draggable:!0,onDragStart:function(e){return function(e,t){e.dataTransfer.setData("itemIndex",t)}(e,t)},onDrop:function(e){return function(e,t){var r=e.dataTransfer.getData("itemIndex"),i=t,c=(0,o.Z)(n),s=c[i];c[i]=c[r],c[r]=s,a(c)}(e,t)},children:[(0,r.jsx)(g.default.Meta,{onClick:function(){x(!0),y(e)},avatar:(0,r.jsx)(h.C,{children:t+1}),title:e.title}),(0,r.jsx)(w,{className:"text-danger float-right",onClick:function(){return T(t,e)}})]})}})]})}),(0,r.jsxs)(m.Z,{title:"update lesson",visible:l,onCancel:function(){return x(!1)},footer:null,children:[(0,r.jsx)(A,{currentItem:j,setCurrentItem:y,handleUpdateLesson:z,handleVideo:L,uploadVideoButtonText:C,progress:Z,uploading:P}),JSON.stringify(j,null,4)]})]})}},8968:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/instructor/course/edit/[slug]",function(){return n(8744)}])}},function(e){e.O(0,[577,576,860,67,4,391,74,778,774,888,179],(function(){return t=8968,e(e.s=t);var t}));var t=e.O();_N_E=t}]);